CREATE TABLE JOGADOR
(
    ID_JOGADOR  NUMBER(10, 0) NOT NULL,
    NOME        VARCHAR2(100) NOT NULL,
    POSICAO     VARCHAR2(100),
    BI          VARCHAR2(100),
    CONSTRAINT PK_JOGADOR PRIMARY KEY (ID_JOGADOR)
    
);

CREATE TABLE CONTRATADO
(
  ID_JOGADOR  NUMBER(10,0) NOT NULL,
  DATA_INICIO DATE NOT NULL,
  DATA_FIM    DATE NOT NULL,
  CONSTRAINT PK_CONTRATADO PRIMARY KEY (ID_JOGADOR, DATA_INICIO),
  CONSTRAINT FK_CONTRATADO_REF_JOGADDOR FOREIGN KEY (ID_JOGADOR)
        REFERENCES JOGADOR(ID_JOGADOR),
  CONSTRAINT CK_CONTRATADO CHECK(DATA_FIM > DATA_INICIO)
);

ALTER TABLE JOGADOR RENAME TO JOGADORES;

ALTER TABLE JOGADORES RENAME TO JOGADOR;

ALTER TABLE JOGADOR ADD APELIDO VARCHAR2(30); 

ALTER TABLE JOGADOR RENAME COLUMN APELIDO TO NICKNAME;

DESC JOGADOR;

ALTER TABLE JOGADOR MODIFY POSICAO NUMBER(5,0);

ALTER TABLE JOGADOR DROP COLUMN BI CASCADE CONSTRAINTS;

ALTER TABLE CONTRATADO 
DROP CONSTRAINT FK_CONTRATADO_REF_JOGADDOR;

DROP TABLE JOGADOR;

ALTER TABLE CONTRATADO
ADD CONSTRAINT FK_CONTRATADO_REF_JOGADDOR 
FOREIGN KEY (ID_JOGADOR) REFERENCES JOGADOR(ID_JOGADOR); 

ALTER TABLE CONTRATADO
DISABLE CONSTRAINT FK_CONTRATADO_REF_JOGADDOR;

ALTER TABLE CONTRATADO
ENABLE CONSTRAINT FK_CONTRATADO_REF_JOGADDOR;

DESC CONTRATADO;

INSERT INTO JOGADOR
(ID_JOGADOR, NOME, POSICAO, NICKNAME)
VALUES (1, 'JOGADOR 1', 2, 'JOGADOR TÁTICO');

INSERT INTO JOGADOR
(ID_JOGADOR, NOME, POSICAO, NICKNAME)
VALUES (2, 'JOGADOR 2', 1, 'JOGADOR');

SELECT * FROM JOGADOR;

INSERT INTO CONTRATADO
(ID_JOGADOR, DATA_INICIO, DATA_FIM)
VALUES
(1, TO_DATE('09-02-2018'), TO_DATE('09-02-2019'));

INSERT INTO CONTRATADO
(ID_JOGADOR, DATA_INICIO, DATA_FIM)
VALUES
(2, TO_DATE('09-02-2019'), TO_DATE('09-02-2020'));

SELECT * FROM CONTRATADO;

UPDATE JOGADOR
SET NICKNAME = 'JOGADOR TÁTICO'
WHERE ID_JOGADOR = 1;

UPDATE JOGADOR
SET NOME = 'Alexander', POSICAO = 5
WHERE ID_JOGADOR = 1;

SELECT * FROM JOGADOR;

SELECT * FROM CONTRATADO;

DELETE FROM CONTRATADO
WHERE ID_JOGADOR = 2;

CREATE OR REPLACE PROCEDURE ADD_JOGADOR
(JOGADOR_ID_IN IN NUMBER,
JOGADOR_NAME_IN IN VARCHAR2,
JOGADOR_POS_IN IN NUMBER,
JOGADOR_APELIDO_IN IN VARCHAR2)
IS
BEGIN
INSERT INTO JOGADOR
(ID_JOGADOR, NOME, POSICAO, NICKNAME)
VALUES
(JOGADOR_ID_IN, JOGADOR_NAME_IN, JOGADOR_POS_IN, JOGADOR_APELIDO_IN);

EXCEPTIONS 
   WHEN DUP_VAL_ON_INDEX THEN 
        RAISE_APPLICATION_ERROR (-20001, 'CÓDIGO DO JOGADOR DUPLICADO');
    WHEN OTHERS THEN
        RAISE_APPLICATION_ERROR (-20002, 'ALGUM ERRO ACONTECEU');

END;
